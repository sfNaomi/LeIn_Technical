<?xml version="1.0" encoding="UTF-8"?>
<CustomField xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>NextDeliveryDate__c</fullName>
    <externalId>false</externalId>
    <formula>IF(ISPICKVAL(Frequency__c,&quot;W&quot;),IF(AND(VALUE(LEFT(SecondaryGridNumber__c,1))!=0,TODAY()&gt;SecondaryStartDate__c),IF(WEEKDAY(Today__c)=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c,IF(WEEKDAY(Today__c)=7,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(Today__c)=1,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(Today__c)&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(Today__c)),IF(AND(WEEKDAY(Today__c)&gt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),WEEKDAY(Today__c)&lt;=(VALUE(LEFT(SecondaryGridNumber__c,1))+1)),Today__c+(VALUE(LEFT(SecondaryGridNumber__c,1))+1-WEEKDAY(Today__c)),Today__c+(7-(WEEKDAY(Today__c)-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))))),IF(WEEKDAY(Today__c)=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c,IF(WEEKDAY(Today__c)=7,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(Today__c)=1,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(Today__c)&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(Today__c)),Today__c+(7-(WEEKDAY(Today__c)-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))))),IF(ISPICKVAL(Frequency__c,&quot;F&quot;),IF(OR(CurrentWeek__c=&quot;1&quot;,CurrentWeek__c=&quot;3&quot;),IF(WEEKDAY(Today__c)=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+14,IF(WEEKDAY(Today__c)=7,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1))+1+7,IF(WEEKDAY(Today__c)=1,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1))+7,IF(WEEKDAY(Today__c)&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+7+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(Today__c)),Today__c+14-(WEEKDAY(Today__c)-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))),IF(WEEKDAY(Today__c)=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+7,IF(WEEKDAY(Today__c)=7,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(Today__c)=1,Today__c+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(Today__c)&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),Today__c+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(Today__c)),Today__c+7-(WEEKDAY(Today__c)-VALUE(LEFT(PrimaryGridNumber__c,1))-1)))))),MonthlyNextDeliveryDate__c))</formula>
    <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
    <label>Next Delivery Date</label>
    <required>false</required>
    <type>Date</type>
</CustomField>
