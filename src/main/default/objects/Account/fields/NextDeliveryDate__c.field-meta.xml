<?xml version="1.0" encoding="UTF-8"?>
<CustomField xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>NextDeliveryDate__c</fullName>
    <externalId>false</externalId>
    <formula>IF(ISPICKVAL(Frequency__c,&quot;W&quot;),IF(VALUE(LEFT(SecondaryGridNumber__c,1))!=0,IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY(),IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),IF(AND(WEEKDAY(TODAY())&gt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),WEEKDAY(TODAY())&lt;=(VALUE(LEFT(SecondaryGridNumber__c,1))+1)),TODAY()+(VALUE(LEFT(SecondaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+(7-(WEEKDAY(TODAY())-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))))),IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY(),IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+7-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))),IF(ISPICKVAL(Frequency__c,&quot;1&quot;),IF(CurrentWeek__c=&quot;1&quot;,IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY(),IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1+7,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+7,IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+14-(WEEKDAY(TODAY())-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))),IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+7,IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+7+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+7-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))),IF(ISPICKVAL(Frequency__c,&quot;2&quot;),IF(CurrentWeek__c=&quot;1&quot;,IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+7,IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1)),IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+7+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+7-VALUE(LEFT(PrimaryGridNumber__c,1))-1)))),IF(WEEKDAY(TODAY())=(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY(),IF(WEEKDAY(TODAY())=7,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+1+7,IF(WEEKDAY(TODAY())=1,TODAY()+VALUE(LEFT(PrimaryGridNumber__c,1))+7,IF(WEEKDAY(TODAY())&lt;(VALUE(LEFT(PrimaryGridNumber__c,1))+1),TODAY()+(VALUE(LEFT(PrimaryGridNumber__c,1))+1-WEEKDAY(TODAY())),TODAY()+(14-(WEEKDAY(TODAY())-VALUE(LEFT(PrimaryGridNumber__c,1))-1))))))),TODAY()-30)))</formula>
    <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
    <label>Next Delivery Date</label>
    <required>false</required>
    <type>Date</type>
</CustomField>
